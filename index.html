<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Massive Options Scanner (Prototype)</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    input, button { padding: 8px; margin: 5px 0; width: 100%; }
    pre { background: #f4f4f4; padding: 10px; white-space: pre-wrap; }
  </style>
</head>
<body>

  <h2>Massive Options Scanner (Prototype)</h2>

  <label>Your Massive API Key:</label>
  <input id="apiKeyInput" type="text" placeholder="Enter Massive API key" />

  <button onclick="saveKey()">Save API Key</button>
  <button onclick="testRequest()">Test Request (AAPL)</button>

  <h3>Response:</h3>
  <pre id="output">Click 'Test Request'â€¦</pre>

<script>
  // Load saved key into input
  document.getElementById("apiKeyInput").value =
    localStorage.getItem("massive_api_key") || "";

  function saveKey() {
    const key = document.getElementById("apiKeyInput").value.trim();
    if (!key) {
      alert("Please enter an API key.");
      return;
    }
    localStorage.setItem("massive_api_key", key);
    alert("API key saved!");
  }

  async function testRequest() {
    const key = document.getElementById("apiKeyInput").value.trim();
    if (!key) {
      alert("Please enter your Massive API key first.");
      return;
    }

    const url = `https://api.massive.xyz/v3/snapshot/options/AAPL`;

    try {
      const res = await fetch(url, {
        headers: {
          "x-api-key": key,
          "Accept": "application/json"
        }
      });

      const data = await res.json();
      document.getElementById("output").textContent =
        JSON.stringify(data, null, 2);

    } catch (err) {
      document.getElementById("output").textContent =
        "ERROR:\n" + err.toString();
    }
  }
</script>

</body>
</html>
